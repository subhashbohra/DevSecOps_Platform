jq '{
  version: "2.1.0",
  runs: [
    {
      tool: {
        driver: {
          name: "CodeQL",
          rules: (
            [(.runs[].tool.driver.rules? // []),
             (.runs[].tool.extensions[].rules? // [])]
            | map(if type == "array" then . else [.] end)
            | flatten
          )
        }
      },
      results: .runs[0].results
    }
  ]
}' ./_codeql_scanned_result/java.sarif > ./_codeql_scanned_result/fixed.sarif
